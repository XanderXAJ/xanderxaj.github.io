<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>Posts</title>
  <meta property="og:title" content="Posts" />
  <meta name="twitter:title" content="Posts" />
  <meta name="author" content="Alex Palmer"/>
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@XanderXAJ" />
  <meta name="twitter:creator" content="@XanderXAJ" />
  <meta property="og:url" content="/post/" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Forged Defiance" />

  <meta name="generator" content="Hugo 0.42.1" />
  <link rel="canonical" href="/post/" />
  <link rel="alternate" href="/post/index.xml" type="application/rss+xml" title="Forged Defiance">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css" integrity="sha384-wITovz90syo1dJWVh32uuETPVEtGigN07tkttEqPv+uR2SE/mbQcG7ATL28aI9H0" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <link rel="stylesheet" href="/css/main.css" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" /><link rel="stylesheet" href="/css/syntax.css" /><link rel="stylesheet" href="/css/codeblock.css" />



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css" integrity="sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css" integrity="sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R" crossorigin="anonymous">



<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

</head>

  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">Forged Defiance</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="About" href="/about">About</a>
            </li>
          
        
          
            <li>
              <a title="Contact" href="/contact">Contact</a>
            </li>
          
        
          
            <li>
              <a title="Privacy Policy" href="/privacy-policy">Privacy Policy</a>
            </li>
          
        

        

        
      </ul>
    </div>

    <div class="avatar-container">
      <div class="avatar-img-border">
        
      </div>
    </div>

  </div>
</nav>




    
  <header class="header-section ">
    <div class="intro-header no-img">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="page-heading">
              <h1>Posts</h1>
              <hr class="small">
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>

    
  <div class="container" role="main">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        
        <div class="posts-list">
          
            <article class="post-preview">
              <a href="/post/backup-and-restore-a-stock-android-device/">
                <h2 class="post-title">Backup and restore a stock Android device</h2>

                
              </a>

              <p class="post-meta">
                <span class="post-meta">
  
  
  <i class="fa fa-calendar-o"></i>&nbsp;Posted on July 14, 2018
  
  
  
</span>


              </p>
              <div class="post-entry">
                
                  

<h1 id="overview">Overview</h1>

<p>Taking regular backups of important devices is sensible advice.  And backups themselves are no good unless you can restore them.  This guide gives a brief overview on how to backup and restore a stock Android device &ndash; that is, a device that runs an uncustomised version of Android, that is unrooted.  It may also work for non-stock Android devices.</p>

<p><strong>One big caveat:</strong> While this is the best method I have found without root, I have not had consistent results across devices when restoring backups, even among Nexus devices.  So I recommend that this method is not relied upon exclusively for backup.</p>

<h1 id="usage-information">Usage information</h1>

<p>We will be using <code>adb backup</code> and <code>adb restore</code> to backup and restore device state.</p>

<p>To find out usage information for your device, connect it and run:</p>

<pre><code>adb shell bu help
</code></pre>

<p>This info was found by simply running <code>adb</code>.</p>

<p>This guide assumes the <code>backup</code> and <code>restore</code> commands work like stock Android devices.</p>

<h1 id="backup">Backup</h1>

<ol>
<li><p>Set up your computer and device so that your computer can access the device via USB.  There are plenty of good guides out there, but in summary this&rsquo;ll involve enabling USB debugging on the device and installing the Android SDK Platform Tools.</p></li>

<li><p>Run the following command, authorising your computer to access the device if you have not already:</p>

<pre><code>adb backup -apk -obb -shared -all -system
</code></pre></li>

<li><p>Follow the instructions.  In my case, I needed to unlock the device and confirm the backup operation (optionally entering a password to encrypt the backup).</p></li>
</ol>

<p>This will store a file in the current working directory.</p>

<h1 id="restore">Restore</h1>

<ol>
<li><p>Ensure the device to restore to is connected.</p></li>

<li><p>Run:</p>

<pre><code>adb restore &lt;path_to_backup&gt;
</code></pre></li>
</ol>

                
              </div>

              

            </article>
          
            <article class="post-preview">
              <a href="/post/using-netrc-with-curl-for-automatic-authorisation/">
                <h2 class="post-title">Using .netrc with curl for Automatic Authorisation</h2>

                
              </a>

              <p class="post-meta">
                <span class="post-meta">
  
  
  <i class="fa fa-calendar-o"></i>&nbsp;Posted on July 10, 2018
  
  
  
</span>


              </p>
              <div class="post-entry">
                
                  <p>The <code>~/.netrc</code> file can store credentials.  This can include things like OAuth tokens and plain text passwords.</p>

<p><strong>Warning:</strong> Be very careful if you decide to store passwords in this file.  The file is not encrypted, so you&rsquo;ll be storing your password in plain text on the disk.  This is generally a bad idea!</p>

<p>First, create the file and make it readable by only yourself:</p>

<pre><code>touch ~/.netrc
chmod go= ~/.netrc
</code></pre>

<p>Then edit the file to contain lines that look like the following (one line per machine):</p>

<pre><code>machine the.address.tld login the-username password the-password
</code></pre>

<p><code>curl</code> can then read this file by providing the <code>--netrc</code> option:</p>

<pre><code>curl --netrc http://the.address.tld/classified
</code></pre>

                
              </div>

              

            </article>
          
            <article class="post-preview">
              <a href="/post/ignore-a-package-update-when-using-fedora-and-kde/">
                <h2 class="post-title">Ignore a Package Update When Using Fedora and KDE</h2>

                
              </a>

              <p class="post-meta">
                <span class="post-meta">
  
  
  <i class="fa fa-calendar-o"></i>&nbsp;Posted on July 5, 2018
  
  
  
</span>


              </p>
              <div class="post-entry">
                
                  <p>Recently I wrote about <a href="/post/escape-login-loop-in-fedora/">Escaping a login loop when using Fedora</a>.  Well, once I had downgraded the package, I wanted to ensure that it would not get automatically updated again!</p>

<p>To ignore the package when performing updated via dnf, add an <code>exclude=&lt;package&gt;</code> line to <code>/etc/dnf/dnf.conf</code>.  For example:</p>

<pre><code>[main]
gpgcheck=1
installonly_limit=3
clean_requirements_on_remove=True
exclude=sddm
</code></pre>

<p><code>dnf</code> no longer requests me to update SDDM.</p>

<p>Unfortunately, the built-in updater for KDE (which I blieve is PackageKit) does not honour the settings in <code>dnf.conf</code>.  It will, however, honour <code>exclude=</code> lines in the repo files in <code>/etc/yum.repos.d</code>.</p>

<p>Since I wanted to block an update to SDDM, I edited <code>/etc/yum.repos.d/fedora-updates.repo</code> and added an <code>exclude=sddm</code> directive to the <code>[updates]</code> block:</p>

<pre><code>[updates]
name=Fedora $releasever - $basearch - Updates
failovermethod=priority
#baseurl=http://download.fedoraproject.org/pub/fedora/linux/updates/$releasever/$basearch/
metalink=https://mirrors.fedoraproject.org/metalink?repo=updates-released-f$releasever&amp;arch=$basearch
enabled=1
repo_gpgcheck=0
type=rpm
gpgcheck=1
metadata_expire=6h
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-fedora-$releasever-$basearch
skip_if_unavailable=False
exclude=sddm
</code></pre>

<p>After a while, KDE stopped pestering me to install the SDDM update.</p>

<p>I technically probably only have to add the exclude to the repo files, but this is the process that I went through.  If you&rsquo;re feeling adventurous, you may try only updating the repo files.</p>

                
              </div>

              

            </article>
          
            <article class="post-preview">
              <a href="/post/escape-login-loop-in-fedora/">
                <h2 class="post-title">Escape Login Loop in Fedora</h2>

                
              </a>

              <p class="post-meta">
                <span class="post-meta">
  
  
  <i class="fa fa-calendar-o"></i>&nbsp;Posted on June 30, 2018
  
  
  
</span>


              </p>
              <div class="post-entry">
                
                  <p>The problem seems to be caused by an update to SDDM (Simple Desktop Display Manager).</p>

<p>On Fedora it can be downgraded, but first you need an internet connection.  I enabled my wireless internet connection by running:</p>

<pre><code>nmcli connection up &lt;wireless-network&gt;
</code></pre>

<p>Where <code>&lt;wireless-network&gt;</code> is the SSID of my wireless network.</p>

<p>I then downgraded SDDM:</p>

<pre><code>sudo dnf downgrade sddm
</code></pre>

<p>Logins should then work after a reboot.</p>

                
              </div>

              

            </article>
          
            <article class="post-preview">
              <a href="/post/make-kdesu-use-sudo-aka-stop-asking-for-roots-password/">
                <h2 class="post-title">Make kdesu use sudo (a.k.a. stop asking for root&#39;s password)</h2>

                
              </a>

              <p class="post-meta">
                <span class="post-meta">
  
  
  <i class="fa fa-calendar-o"></i>&nbsp;Posted on June 26, 2018
  
  
  
</span>


              </p>
              <div class="post-entry">
                
                  <p>When I tried to start <code>partitionmanager</code> (KDE Partition Manager) on Fedora 26, it would always ask for the root user&rsquo;s password, despite the fact that the root user was disabled in my setup.</p>

<p>The dialog box that popped up looked like it might be <code>kdesu</code>.  <code>kdesu</code>,. a.k.a. KDE <code>su</code>, is a KDE version of <code>su</code> that allows a process to be run as another user, like root.  When I tried running <code>kdesu</code> separately it asked for root&rsquo;s password again.  So I knew the problem lay within <code>kdesu</code>, not <code>partitionmanager</code>.</p>

<p><a href="https://wiki.archlinux.org/index.php/sudo#kdesu">The ever-helpful Arch wiki contained just the golden nugget I was after</a>: a command that would configure <code>kdesu</code> to use <code>sudo</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kwriteconfig5 --file kdesurc --group super-user-command --key super-user-command sudo</code></pre></div>
<p>This fixed the problem for me, as <code>sudo</code> requests your password, not root&rsquo;s.  Whether you&rsquo;re allowed to run the command depends on the contents of the system&rsquo;s sudoers file.  Look that file up if you continue to have difficulty.</p>

                
              </div>

              

            </article>
          
            <article class="post-preview">
              <a href="/post/run-apache-directory-studio-with-java-10/">
                <h2 class="post-title">Run Apache Directory Studio With Java 10</h2>

                
              </a>

              <p class="post-meta">
                <span class="post-meta">
  
  
  <i class="fa fa-calendar-o"></i>&nbsp;Posted on June 23, 2018
  
  
  
</span>


              </p>
              <div class="post-entry">
                
                  <p>Add <code>--add-modules=ALL-SYSTEM</code> to the end of <code>ApacheDirectoryStudio.ini</code>.</p>

<p>You can find this file:</p>

<ul>
<li>On Linux: in the installation folder</li>
<li>On Mac OS X: <code>/Applications/ApacheDirectoryStudio.app/Contents/ApacheDirectoryStudio.ini</code></li>
<li>On Windows: in the installation folder</li>
</ul>

<p>Source: <a href="http://directory.apache.org/studio/faqs.html">http://directory.apache.org/studio/faqs.html</a></p>

                
              </div>

              

            </article>
          
            <article class="post-preview">
              <a href="/post/re-use-commit-message-in-git/">
                <h2 class="post-title">Re-use Commit Message in Git</h2>

                
              </a>

              <p class="post-meta">
                <span class="post-meta">
  
  
  <i class="fa fa-calendar-o"></i>&nbsp;Posted on June 3, 2018
  
  
  
</span>


              </p>
              <div class="post-entry">
                
                  <p>To re-use a commit&rsquo;s message verbatim, including authorship and timestamp information, use <code>-C &lt;commit&gt;</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">git commit --amend -C @</code></pre></div>
<p><strong>Pro Tip:</strong> <code>@</code> is a synonym for <code>HEAD</code>, the currently checked-out commit.</p>

<p>To reset the date as well, use <code>--date now</code>; to reset the author too, use <code>--reset-author</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">git commit --amend -C @ --date now
git commit --amend -C @ --reset-author
git commit --amend -C @ --date now --reset-author</code></pre></div>
<p>If you want to use an existing commit&rsquo;s message and also want a chance to edit it, use <code>-c &lt;commit&gt;</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">git commit --amend -c @</code></pre></div>
<p><code>-c</code> is compatible with <code>--date</code> and <code>--reset-author</code> too:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">git commit --amend -c @ --date now
git commit --amend -c @ --reset-author
git commit --amend -c @ --date now --reset-author</code></pre></div>
                
              </div>

              

            </article>
          
            <article class="post-preview">
              <a href="/post/uploading-to-google-play-music-without-matching/">
                <h2 class="post-title">Uploading to Google Play Music without matching</h2>

                
              </a>

              <p class="post-meta">
                <span class="post-meta">
  
  
  <i class="fa fa-calendar-o"></i>&nbsp;Posted on September 10, 2017
  
  
  
</span>


              </p>
              <div class="post-entry">
                
                  <p>I&rsquo;ve had some trouble with Google Play Music&rsquo;s scan and match service.  It sometimes matches tracks to the wrong versions of them.  Sometimes the volume of a track is wildly different from what I have locally (with or without ReplayGain).  Unfortunately, there is no way to disable matching in Google&rsquo;s official Music Manager application.</p>

<p><a href="https://github.com/simon-weber/gmusicapi"><code>gmusicapi</code></a> supports uploading to Google Play Music without their &ldquo;scan and match&rdquo; service.  <a href="https://github.com/thebigmunch/gmusicapi-scripts"><code>gmusicapi-scripts</code></a> utilises <code>gmusicapi</code>.  Let&rsquo;s use them!</p>

<ol>
<li><p>Install <a href="https://thebigmunch.github.io/gmusicapi-scripts">gmusicapi-scripts</a>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Windows
</span><span style="color:#75715e"></span>py -3 -m pip install gmusicapi-scripts
<span style="color:#75715e"># Others
</span><span style="color:#75715e"></span>pip install gmusicapi-scripts</code></pre></div></li>

<li><p>Convert tracks (if needed) to 320kbps MP3 and place them in <code>&lt;directory&gt;</code>.</p>

<ul>
<li>If you place non-MP3 files in this directory, <code>gmsync</code> will try to convrt them with FFMPEG or AVConv if they are on the <code>PATH</code>.  <a href="https://thebigmunch.github.io/gmusicapi-scripts">Look at the docs</a> to see what formats it supports.</li>
</ul></li>

<li><p>Run <code>gmsync</code>.  Follow any instructions it provides:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">gmsync up &lt;directory&gt;</code></pre></div></li>
</ol>

<p><code>gmsync</code> uploads without matching by default. Perfect.</p>

                
              </div>

              

            </article>
          
            <article class="post-preview">
              <a href="/post/working-around-intel-cpu-running-at-a-maximum-of-49-50/">
                <h2 class="post-title">Working around Intel CPU Running at a Maximum of 49%/50%</h2>

                
              </a>

              <p class="post-meta">
                <span class="post-meta">
  
  
  <i class="fa fa-calendar-o"></i>&nbsp;Posted on June 10, 2017
  
  
  
</span>


              </p>
              <div class="post-entry">
                
                  <p>My laptop had been feeling slower than it had used to, and I was getting more and more certain that it wasn&rsquo;t just me.</p>

<p>One time I opened Task Manager and noticed that whenever I put load on the machine, it maxed out at 49%.  Every time.  Cooling wasn&rsquo;t the issue as the laptop fan (which is a dumb fan controlled by hardware, not software) wasn&rsquo;t spinning up much.</p>

<p>After searching online, <a href="https://answers.microsoft.com/en-us/windows/forum/windows_10-other_settings/windows-10-only-use-half-of-max-cpu-speed/d97b219f-10ee-4a42-a0fc-d517c1b60be8">I stumbled across a thread</a> that would provide the (really rather insane) workaround: Move the Intel processor driver so Windows does not use it.  Thanks to everyone there for the discussion.</p>

<ol>
<li>Restart in the advanced command prompt mode.  (Hold Shift when clicking Restart)</li>
<li>Log in to your account.</li>

<li><p>Run the following:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">cd drivers
move intelppm.sys intelppm.sys.old
exit</code></pre></div></li>

<li><p>Select the option to exit and continue to Windows 10.</p></li>
</ol>

<p>One comment on that thread suggests that this also works for AMD CPUs by moving <code>amdppm.sys</code> instead of <code>intelppm.sys</code>.</p>

<p><strong>Update 2017-06-23</strong>: I previously suggested to add the <code>.bak</code> extension to the driver file.  However, Windows recognises this extension, and so it will restore the driver back to its original location at the next restart, meaning the problem will return!  I&rsquo;ve changed the instructions to suggest using <code>.old</code> instead, which I don&rsquo;t believe Windows recognises, but is still fairly obvious to users.</p>

                
              </div>

              

            </article>
          
            <article class="post-preview">
              <a href="/post/tips-for-ripping-blu-ray-audio/">
                <h2 class="post-title">Tips for Ripping Blu-Ray Audio</h2>

                
              </a>

              <p class="post-meta">
                <span class="post-meta">
  
  
  <i class="fa fa-calendar-o"></i>&nbsp;Posted on April 29, 2017
  
  
  
</span>


              </p>
              <div class="post-entry">
                
                  

<p>I recently ripped my first Blu-Ray audio discs.  Here are a few tips I&rsquo;ve discovered along the way:</p>

<h2 id="tl-dr">tl;dr</h2>

<p>Backup the disc using <a href="http://www.makemkv.com/download/">MakeMKV</a> and extract the audio using the updated version of the command under <em>Putting it all together</em>.</p>

<h2 id="ripping-the-discs">Ripping the discs</h2>

<p><a href="http://www.makemkv.com/download/">MakeMKV</a> can be used to rip and, if necessary, decrypt Blu-Ray audio discs.  While it is in beta, it can be evaluated by <a href="http://www.makemkv.com/forum2/viewtopic.php?f=5&amp;t=1053">using the current beta key</a>.</p>

<p>I use the complete Blu-Ray backup feature so I have the raw stream files to work with.</p>

<h2 id="extracting-the-audio-from-the-video-files">Extracting the audio from the video files</h2>

<p><a href="http://ffmpeg.org/">ffmpeg</a> can be used to extract the audio track(s) from the video streams on the Blu-Ray.</p>

<p>First interrogate one of your streams using <code>ffprobe</code> to see how the different tracks are laid out:</p>

<pre><code>ffprobe -hide_banner BDMV/STREAM/00002.m2ts
</code></pre>

<p>I use <code>-hide_banner</code> to reduce the amount of text printed to the terminal.  If you have troubles and decide to ask others for help, be sure to omit <code>-hide_banner</code> as the information it emits can be useful when debugging!</p>

<p>Here is the output I got:</p>

<pre><code>Input #0, mpegts, from 'BDMV/STREAM/00002.m2ts':
  Duration: 00:01:47.07, start: 4200.000000, bitrate: 7133 kb/s
  Program 1
    Stream #0:0[0x1011]: Video: h264 (High) (HDMV / 0x564D4448), yuv420p(progressive), 1920x1080 [SAR 1:1 DAR 16:9], 23.98 fps, 23.98 tbr, 90k tbn, 47.95 tbc
    Stream #0:1[0x1100]: Audio: pcm_bluray (HDMV / 0x564D4448), 48000 Hz, stereo, s16, 1536 kb/s
</code></pre>

<p>In my case I only have one audio stream to worry about at address <code>0:1</code>.  Note it is labelled <code>s16</code> which means that it is a signed 16-bit depth audio stream.  These details will be important in a moment.</p>

<p>Next comes the extraction:</p>

<p><em>Update 2017-09-10:</em> I now think it is much more straightforward to trust FFMPEG to do the right thing:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#66d9ef">for</span> i in BDMV/STREAM/*.m2ts; <span style="color:#66d9ef">do</span> ffmpeg -hide_banner -i <span style="color:#e6db74">&#34;</span>$i<span style="color:#e6db74">&#34;</span> -map <span style="color:#ae81ff">0</span>:1 <span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>basename <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>i%.*<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">.flac&#34;</span>; <span style="color:#66d9ef">done</span></code></pre></div>
<p>Note that I do not set the audio codec, and merely set the file extension to <code>.flac</code> as that is the format that I want.</p>

<p>For reference, this is original command I used:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#66d9ef">for</span> i in BDMV/STREAM/*.m2ts; <span style="color:#66d9ef">do</span> ffmpeg -hide_banner -i <span style="color:#e6db74">&#34;</span>$i<span style="color:#e6db74">&#34;</span> -map <span style="color:#ae81ff">0</span>:1 -acodec pcm_s16le <span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>basename <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>i%.*<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">.wav&#34;</span>; <span style="color:#66d9ef">done</span></code></pre></div>
<p>The <code>-map 0:1</code> refers to our address from earlier.  The <code>s16</code> part of <code>-acodec pcm_s16le</code> matches the description of the stream <code>ffprobe</code> gave us.  We cannot use <code>-acodec copy</code> as <code>ffmpeg</code> cannot encode <code>pcm_bluray</code>.</p>

<p>Make sure to use <code>.wav</code> at the end of the filename, as <code>ffmpeg</code> considers it important.  I was originally trying to use <code>.pcm</code>, but all I got was this error message:</p>

<pre><code>[NULL @ 000000000283dc20] Unable to find a suitable output format for '00002.pcm'
</code></pre>

<p>If you have multiple streams, re-run this command, changing <code>-map</code>, <code>-acodec</code> and the output filename (to not overwrite your previous extractions!) as appropriate.</p>

<h2 id="removing-initial-silence">Removing initial silence</h2>

<p>After I had extracted the audio, I noticed that every track had about 1.0-1.6 seconds of silence at the beginning.  I had no interest in keeping this, so I used <code>ffmpeg</code> with the <a href="https://ffmpeg.org/ffmpeg-filters.html#silenceremove"><code>silenceremove</code> filter</a>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">mkdir no-silence
<span style="color:#66d9ef">for</span> i in *.wav; <span style="color:#66d9ef">do</span> ffmpeg -i <span style="color:#e6db74">&#34;</span>$i<span style="color:#e6db74">&#34;</span> -af silenceremove<span style="color:#f92672">=</span>start_periods<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>:detection<span style="color:#f92672">=</span>peak <span style="color:#e6db74">&#34;no-silence/</span><span style="color:#66d9ef">$(</span>basename <span style="color:#e6db74">&#34;</span>$i<span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>; <span style="color:#66d9ef">done</span></code></pre></div>
<p><code>start_periods=1</code> means remove one block of silence from the beginning of the track, a.k.a. the silence before any audio begins.  I use <code>detection=peak</code> because I know I&rsquo;m working with audio with digital silence; if you&rsquo;re working with audio that was originally recorded from analogue, omit this option.</p>

<h2 id="putting-it-all-together">Putting it all together</h2>

<p>Incidentally, this filter could have been added to the original extraction command, if I knew that I wanted it at the time. :)</p>

<p><em>Update 2017-09-10:</em> As above, I now think it is much more straightforward to trust FFMPEG to do the right thing:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#66d9ef">for</span> i in BDMV/STREAM/*.m2ts; <span style="color:#66d9ef">do</span> ffmpeg -hide_banner -i <span style="color:#e6db74">&#34;</span>$i<span style="color:#e6db74">&#34;</span> -map <span style="color:#ae81ff">0</span>:1 -af silenceremove<span style="color:#f92672">=</span>start_periods<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>:detection<span style="color:#f92672">=</span>peak <span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>basename <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>i%.*<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">.flac&#34;</span>; <span style="color:#66d9ef">done</span></code></pre></div>
<p>For reference, this is original command I used:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#66d9ef">for</span> i in BDMV/STREAM/*.m2ts; <span style="color:#66d9ef">do</span> ffmpeg -hide_banner -i <span style="color:#e6db74">&#34;</span>$i<span style="color:#e6db74">&#34;</span> -map <span style="color:#ae81ff">0</span>:1 -acodec pcm_s16le -af silenceremove<span style="color:#f92672">=</span>start_periods<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>:detection<span style="color:#f92672">=</span>peak <span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>basename <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>i%.*<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">.wav&#34;</span>; <span style="color:#66d9ef">done</span></code></pre></div>
<p><em>Update 2017-05-14:</em> Changed <code>${i/.*}</code> to <code>${i%.*}</code> to remove file extensions, as the new way will only remove everything following the last <code>.</code> in the filename, not the first.  Thanks to my good friend <a href="http://m.holland-avery.com/">Mark Holland-Avery</a> for the suggestion!</p>

                
              </div>

              

            </article>
          
        </div>
        
          <ul class="pager main-pager">
            
            
              <li class="next">
                <a href="/post/page/2/">Older Posts &rarr;</a>
              </li>
            
          </ul>
        
      </div>
    </div>
  </div>

    <footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
              <li>
                <a href="https://github.com/XanderXAJ" title="GitHub">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://twitter.com/XanderXAJ" title="Twitter">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://stackoverflow.com/users/5893392/alex-palmer" title="StackOverflow">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-stack-overflow fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://www.youtube.com/channel/UCIqfeTPDnN9doZzKlVXpqww" title="Youtube">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-youtube fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://xanderxaj.bandcamp.com/" title="Bandcamp">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-bandcamp fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
        </ul>
        <p class="credits copyright text-muted">
          
            
              <a href="https://xanderx.com">Alex Palmer</a>
            
          

          &nbsp;&bull;&nbsp;
          2018

          
            &nbsp;&bull;&nbsp;
            <a href="/">Forged Defiance</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          <a href="http://gohugo.io">Hugo v0.42.1</a> powered &nbsp;&bull;&nbsp; Theme by <a href="http://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a> adapted to <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a>
          
        </p>
      </div>
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.js" integrity="sha384-/y1Nn9+QQAipbNQWU65krzJralCnuOasHncUFXGkdwntGeSvQicrYkiUBwsgUqc1" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/contrib/auto-render.min.js" integrity="sha384-dq1/gEHSxPZQ7DdrM82ID4YVol9BYyU7GbWlIwnwyPzotpoc57wDw/guX8EaYGPx" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="/js/main.js"></script><script> renderMathInElement(document.body); </script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js" integrity="sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js" integrity="sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q" crossorigin="anonymous"></script>
<script src="/js/load-photoswipe.js"></script>






  </body>
</html>

