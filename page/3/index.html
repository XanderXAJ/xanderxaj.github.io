<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>Forged Defiance</title>
  <meta property="og:title" content="Forged Defiance" />
  <meta name="twitter:title" content="Forged Defiance" />
  <meta name="author" content="Alex Palmer"/>
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@XanderXAJ" />
  <meta name="twitter:creator" content="@XanderXAJ" />
  <meta property="og:url" content="/" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Forged Defiance" />

  <meta name="generator" content="Hugo 0.45" />
  <link rel="canonical" href="/" />
  <link rel="alternate" href="/index.xml" type="application/rss+xml" title="Forged Defiance">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css" integrity="sha384-wITovz90syo1dJWVh32uuETPVEtGigN07tkttEqPv+uR2SE/mbQcG7ATL28aI9H0" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <link rel="stylesheet" href="/css/main.css" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" /><link rel="stylesheet" href="/css/syntax.css" /><link rel="stylesheet" href="/css/codeblock.css" />



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css" integrity="sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css" integrity="sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R" crossorigin="anonymous">



<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

</head>

  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">Forged Defiance</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="About" href="/about">About</a>
            </li>
          
        
          
            <li>
              <a title="Contact" href="/contact">Contact</a>
            </li>
          
        
          
            <li>
              <a title="Privacy Policy" href="/privacy-policy">Privacy Policy</a>
            </li>
          
        

        

        
      </ul>
    </div>

    <div class="avatar-container">
      <div class="avatar-img-border">
        
      </div>
    </div>

  </div>
</nav>




    
  
  
  




  

  <header class="header-section ">
    
    <div class="intro-header no-img">
      
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="page-heading">
              <h1>Forged Defiance</h1>
                
                
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>


    
  <div role="main" class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        

        <div class="posts-list">
          
          
            <article class="post-preview">
              <a href="/post/connecting-to-an-adb-over-network-android-device/">
                <h2 class="post-title">Connecting to an ADB-over-network Android device</h2>
                
                
              </a>

              <span class="post-meta">
  
  
  <i class="fa fa-calendar-o"></i>&nbsp;Posted on February 6, 2016
  
  
  
</span>


              <div class="post-entry">
                
                  <p>Just a quick reminder to myself in future.</p>

<p>To connect to an Android device using ADB over network (in my case when using cyanogen mod), use the following command:</p>

<pre><code>adb connect &lt;IP address/hostname&gt;
</code></pre>

                
              </div>

              
            </article>
          
            <article class="post-preview">
              <a href="/post/kodi-with-sony-bravia-tvs/">
                <h2 class="post-title">Kodi with Sony Bravia TVs</h2>
                
                
              </a>

              <span class="post-meta">
  
  
  <i class="fa fa-calendar-o"></i>&nbsp;Posted on December 26, 2015
  
  
  
</span>


              <div class="post-entry">
                
                  <p>I&rsquo;ve been setting up Kodi on my Sony Bravia Android TV &mdash; you can install it from the Google Play Store.</p>

<p>Here are a few notes to help set things up how I like them:</p>

<ul>
<li>My favourite skin so far is <strong>Arctic: Zephyr</strong> as it doesn&rsquo;t have lots of gaudy images, runs fast, and displays long titles reasonably well (good for both music and long video names).</li>
<li>I&rsquo;ve added some useful functions to the Sony remote control; install the <strong>Keymap Editor</strong> add-on and then make the following adjustments:

<ul>
<li><strong>Information (i+) button</strong>: Global &gt; Navigation &gt; Context Menu</li>
<li><strong>Red button</strong> : Global &gt; Window &gt; Open Home</li>
<li><strong>Green button</strong>: Global &gt; Window &gt; Open Favourites</li>
<li><strong>Yellow button</strong>: Global &gt; Window &gt; Open Fullscreen Video <em>(allows you to return to a video if you go in to a menu)</em></li>
<li><strong>Blue button</strong>: <em>Nothing yet!</em></li>
</ul></li>
</ul>

<p><em>Update 2017-05-14:</em> The new Estuary skin that comes as default in Kodi 17 is exactly to my tastes so I use that now.</p>

                
              </div>

              
            </article>
          
            <article class="post-preview">
              <a href="/post/building-and-testing-a-jekyll-website-on-windows-with-docker/">
                <h2 class="post-title">Building and Testing a Jekyll website with Docker on Windows</h2>
                
                
              </a>

              <span class="post-meta">
  
  
  <i class="fa fa-calendar-o"></i>&nbsp;Posted on November 8, 2015
  
  
  
</span>


              <div class="post-entry">
                
                  

<p>I&rsquo;ve recently talked about [how I&rsquo;ve changed my website to be created with Jekyll][migrate-to-jekyll].  One of the big reasons was to simplify how the site is built and run.</p>

<p>Well, if it&rsquo;s so simple now, then I should be able to modify it on the go within Windows, right?  I&rsquo;ve recently been using an openSUSE VM to modify the site, but figured I could do one better and operate (mostly) natively.  This article describes my solution.</p>

<p>It is assumed that you already have a Jekyll site to work with.</p>

<p>Much of this will also work for anyone using the Linux or Mac OS X versions of Docker Toolbox, but I&rsquo;m approaching with a view to running this on Windows.</p>

<p>[migrate-to-jekyll]: {% post_url 2015-10-04-migrating-from-wordpress-to-jekyll %}</p>

<h1 id="install-docker-toolbox">Install Docker Toolbox</h1>

<p><a href="https://www.docker.com/docker-toolbox">Install Docker Toolbox</a>.  If you&rsquo;re not familiar with Docker or Docker Toolbox, I highly recommend you <a href="http://docs.docker.com/windows/started/">go through their tutorials</a>.</p>

<p>One note: If you already have VirtualBox installed or prefer to install it yourself, uncheck the VirtualBox option in the installer.</p>

<h1 id="create-a-docker-machine">Create a Docker Machine</h1>

<p>Docker Toolbox creates a couple of shortcuts for you.  If you run <em>Docker Quickstart Terminal</em>, a machine called <code>default</code> will be automatically created for you.</p>

<p>Alternatively, you can create one with your own name from the command line:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">  docker-machine create --driver virtualbox dev</code></pre></div>
<p>As you&rsquo;ll see later on, I decided to go the route of managing this myself with my build script.</p>

<h1 id="create-dockerfile">Create Dockerfile</h1>

<p>To run Jekyll in Docker, you need to build a Docker image!</p>

<p>It struck me as simplest to build my own:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Dockerfile" data-lang="Dockerfile">  FROM debian:latest<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>  # Install jekyll dependencies<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>  RUN apt-get update <span style="color:#f92672">&amp;&amp;</span> apt-get -y install <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  	gcc <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  	make <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  	nodejs <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  	python <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  	ruby <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  	ruby-dev <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  	<span style="color:#f92672">&amp;&amp;</span> gem install bundler<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>  # Install site dependencies<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>  WORKDIR /site<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>  COPY Gemfile Gemfile.lock /site/<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>  RUN bundle install<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>  # Copy site files<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>  COPY . /site/<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>  CMD <span style="color:#f92672">[</span><span style="color:#e6db74">&#34;bundle&#34;</span>, <span style="color:#e6db74">&#34;exec&#34;</span>, <span style="color:#e6db74">&#34;jekyll&#34;</span>, <span style="color:#e6db74">&#34;serve&#34;</span>, <span style="color:#e6db74">&#34;--port=4000&#34;</span>, <span style="color:#e6db74">&#34;--host=0.0.0.0&#34;</span><span style="color:#f92672">]</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>  EXPOSE <span style="color:#ae81ff">4000</span></code></pre></div>
<p>I chose port 4000 as it isn&rsquo;t either 8000 or 8080, which can be commonly used by other applications.</p>

<p>You&rsquo;ll note that <code>Gemfile</code> and <code>Gemfile.lock</code> are copied first.  Docker creates a layer out of each instruction (e.g. <code>RUN</code>, <code>COPY</code>) in the <code>Dockerfile</code>, and caches them.  This means a layer only needs to be rebuilt if it or one of its parents has changed.  These copied files are used to install your website&rsquo;s dependencies, and since this is generally quite a slow operation compared to actually building the site, I opt to get the install done first and utilise Docker&rsquo;s layer cache.</p>

<h1 id="create-dockerignore-and-why-it-s-needed">Create .dockerignore (and why it&rsquo;s needed)</h1>

<p>Docker builds work by archiving and sending the <em>entire</em> contents of the current working directly to the Docker daemon &mdash; the build does not happen on your local machine, but entirely on the remote machine.</p>

<p>This means that if you have many temp, cache or large files that are not needed for the build, they will needlessly slow the build down.  to counter this, a <code>.dockerfile</code> can be created to tell the local Docker client which files the remote Docker daemon will not need.</p>

<p><code>.dockerignore</code> works very similar to <code>.gitignore</code>.  I&rsquo;ll make a very simple one that ignores <code>_site</code>, just in case a build has happened locally:</p>

<pre><code>  _site
</code></pre>

<h1 id="create-powershell-build-script">Create PowerShell build script</h1>

<p>I created a build script, <code>build.ps1</code>, at the root of my website.  In this build script I create a Docker machine (if it doesn&rsquo;t exist) or start it (if it does), configure Docker to communicate with it, print out instructions on how to see the website, and finally build and serve it:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">  <span style="color:#75715e"># Site building script for Powershell and Docker Toolbox</span>
  <span style="color:#75715e"># Set the name of the machine</span>
  set machine dev

  <span style="color:#75715e"># Set up and/or start the machine -- note that create also starts the machine</span>
  docker-machine create --driver virtualbox $machine
  docker-machine start $machine

  <span style="color:#75715e"># Set up Docker&#39;s env vars so it can connect</span>
  docker-machine env --shell=powershell $machine | Invoke-Expression

  <span style="color:#75715e"># We now need a means to connect to the website once it runs.  there are two methods:</span>
  <span style="color:#75715e"># Method 1: Enable forwarding the port -- with thanks to http://stackoverflow.com/a/32175164</span>
  <span style="color:#75715e">#   Only problem with this method is that it needs VBoxManage to be a part of the PATH -- this is a manual change.</span>
  <span style="color:#75715e">#   Example address: http://localhost:4000/</span>
  <span style="color:#75715e">#VBoxManage modifyvm $machine --natpf1 &#34;jekyll,tcp,127.0.0.1,4000,,4000&#34;</span>
  <span style="color:#75715e"># Method 2: Connect to the docker machine&#39;s IP directly without port forwarding</span>
  <span style="color:#75715e">#   Example address: http://192.168.99.100:4000/</span>
  docker-machine ip $machine | set ip
  echo <span style="color:#e6db74">&#34;Building website; will be available in a few moments. Press Ctrl+C when done.&#34;</span>
  echo <span style="color:#e6db74">&#34;Connect to: http://${ip}:4000&#34;</span>

  <span style="color:#75715e"># Build and serve the website</span>
  (docker build -t blog .) <span style="color:#f92672">-and</span> (docker run -it --rm --publish=4000<span style="color:#960050;background-color:#1e0010">:</span>4000 blog)</code></pre></div>
<p>Note: The very last command, with the <code>-and</code> in the middle, will absorb all <code>stdout</code>, meaning that things will look very quiet.  Rest assured that if the script doe <em>not</em> end, then things are working fine.</p>

<p>If you update the site and want to see what the changes look like, or are simply finished, press <code>Ctrl+C</code> and then re-run the build script as desired.</p>

<h1 id="profit">Profit</h1>

<p>While not certainly not as easy to modify as when I&rsquo;m on a Linux machine, this is certainly a big improvement on local testing than trying to run a Wordpress stack on Windows!  I&rsquo;ve also learnt a lot about <code>docker-machine</code>.</p>

<p>It may or may not be possible to mount the Windows website directory on to the docker machine in order to allow rebuilds on file modification, but I suspect that may turn out to be difficult, complicated or fragile, and the method described above works for me.  If I change my mind, I&rsquo;ll inevitably describe what I do!</p>

<p>Hopefully this guide helps you out, as well as future me!</p>

                
              </div>

              
            </article>
          
            <article class="post-preview">
              <a href="/post/deploying-jekyll-website-on-git-commit/">
                <h2 class="post-title">Deploying Jekyll website on git commit</h2>
                
                
              </a>

              <span class="post-meta">
  
  
  <i class="fa fa-calendar-o"></i>&nbsp;Posted on November 8, 2015
  
  
  
</span>


              <div class="post-entry">
                
                  <p>One reason for [migrating to static site generation][migrate-to-jekyll] is that the site becomes more straightforward to keep in version control systems such as git.  And I do like version control; I naturally ran <code>git init</code> before I ran <code>jekyll new</code>!</p>

<p>In my workflow, once I have made and committed changes locally, I push the changes remotely.  But now I need to build and deploy the new version of the site.  What if I could get that to happen automatically?</p>

<p>To do this, I set up my web server to accept git commands; this is a topic unto itself which I might write about some time.</p>

<p>I then create a bare repo:</p>

<pre><code>  git init --bare blog.git
</code></pre>

<p>After setting permissions as appropriate, I can now push my git repo to the web server:</p>

<pre><code>  git remote add origin https://user@your.website.tld/git/blog.git
  git push -u origin master
</code></pre>

<p>I then modified <a href="http://jekyllrb.com/docs/deployment-methods/#git-post-receive-hook">an example git-hook</a> I found on the Jekyll website to be more robust and meet my needs.  There are a few things to take note of here:</p>

<ul>
<li>I switched from using the <code>git-receive</code> hook as per Jekyll&rsquo;s recommendation to <code>post-receive</code>.  This is because the level of info <code>git-receive</code>, ahem, receives seems a bit overkill &mdash; <code>post-update</code> provides the names of the modified branches, and that&rsquo;s all we need.</li>
<li><code>DEPLOY_REF_REGEX</code> is a regex that matches git-refs, such as branches.  The value in my script means that it&rsquo;ll only deploy the website when changes are pushed to <code>master</code>.  This means you are free to experiment on non-<code>master</code> branches.  I haven&rsquo;t gone so far as to deploy different branches different places!</li>
<li><code>GIT_REPO</code> is the path to your site&rsquo;s git repo.  Ensure it can be read by the webserver.</li>
<li><code>PUBLIC_WWW</code> is where the website needs to be deployed to be visible on the web.  Ensure it is writable by the webserver.</li>
</ul>

<p>To use this hook, create a file called <code>post-update</code> in your <em>remote bare repo&rsquo;s</em> <code>hooks</code> directory.  Ensure it is executable by your webserver!</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">  <span style="color:#75715e">#!/bin/bash
</span><span style="color:#75715e"></span>  <span style="color:#75715e"># Builds and deploys blog when new commits are pushed to the specified branches (default master).
</span><span style="color:#75715e"></span>  <span style="color:#75715e">#
</span><span style="color:#75715e"></span>  <span style="color:#75715e"># Despite the Jekyll site recommending to use the post-receive hook, we do not
</span><span style="color:#75715e"></span>  <span style="color:#75715e"># need the level of information that post-receive gets.  post-update receives
</span><span style="color:#75715e"></span>  <span style="color:#75715e"># each ref that was updated as an argument, and so is sufficient for this
</span><span style="color:#75715e"></span>  <span style="color:#75715e"># script&#39;s needs.
</span><span style="color:#75715e"></span>  <span style="color:#75715e">#
</span><span style="color:#75715e"></span>  <span style="color:#75715e"># The script also adds the commit ID of the deployed commit to the site, so you are able
</span><span style="color:#75715e"></span>  <span style="color:#75715e"># to tell exactly what is live by visiting /deployed_commit.
</span><span style="color:#75715e"></span>  <span style="color:#75715e">#
</span><span style="color:#75715e"></span>  <span style="color:#75715e"># Originally taken from: http://jekyllrb.com/docs/deployment-methods/#git-post-receive-hook
</span><span style="color:#75715e"></span>  <span style="color:#75715e">#
</span><span style="color:#75715e"></span>
  DEPLOY_REF_REGEX<span style="color:#f92672">=</span>refs/heads/master

  GIT_REPO<span style="color:#f92672">=</span>/shared/code/git/blog.git
  PUBLIC_WWW<span style="color:#f92672">=</span>/var/www/blog

  DEPLOY<span style="color:#f92672">=</span>
  <span style="color:#66d9ef">for</span> ref in <span style="color:#e6db74">&#34;</span>$@<span style="color:#e6db74">&#34;</span>; <span style="color:#66d9ef">do</span>
  	<span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> $ref <span style="color:#f92672">=</span>~ $DEPLOY_REF_REGEX <span style="color:#f92672">]]</span>; <span style="color:#66d9ef">then</span>
  		DEPLOY<span style="color:#f92672">=</span>true
  		break
  	<span style="color:#66d9ef">fi</span>
  <span style="color:#66d9ef">done</span>

  <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> $DEPLOY <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
  	TMP_GIT_CLONE<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>mktemp -d<span style="color:#66d9ef">)</span>
  	git clone <span style="color:#e6db74">&#34;</span>$GIT_REPO<span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">&#34;</span>$TMP_GIT_CLONE<span style="color:#e6db74">&#34;</span>
  	echo <span style="color:#66d9ef">$(</span>GIT_DIR<span style="color:#f92672">=</span>.git git -C <span style="color:#e6db74">&#34;</span>$TMP_GIT_CLONE<span style="color:#e6db74">&#34;</span> rev-parse HEAD<span style="color:#66d9ef">)</span> &gt; <span style="color:#e6db74">&#34;</span>$TMP_GIT_CLONE<span style="color:#e6db74">/deployed_commit&#34;</span>
  	jekyll build -s <span style="color:#e6db74">&#34;</span>$TMP_GIT_CLONE<span style="color:#e6db74">&#34;</span> -d <span style="color:#e6db74">&#34;</span>$PUBLIC_WWW<span style="color:#e6db74">&#34;</span>
  	rm -Rf <span style="color:#e6db74">&#34;</span>$TMP_GIT_CLONE<span style="color:#e6db74">&#34;</span>
  <span style="color:#66d9ef">else</span>
  	echo <span style="color:#e6db74">&#34;Updated refs did not match; not deploying.&#34;</span>
  <span style="color:#66d9ef">fi</span>

  exit</code></pre></div>
<p>You&rsquo;ll get output like the following:</p>

<pre><code>  $ git push
  Counting objects: 4, done.
  Delta compression using up to 4 threads.
  Compressing objects: 100% (4/4), done.
  Writing objects: 100% (4/4), 3.15 KiB | 0 bytes/s, done.
  Total 4 (delta 2), reused 0 (delta 0)
  remote: Cloning into '/tmp/tmp.TkcxSnfVnb'...
  remote: done.
  remote: Configuration file: /tmp/tmp.TkcxSnfVnb/_config.yml
  remote:             Source: /tmp/tmp.TkcxSnfVnb
  remote:        Destination: /var/www/blog
  remote:       Generating...
  remote:                     done.
  remote:  Auto-regeneration: disabled. Use --watch to enable.
  To https://user@your.website.tld/git/blog.git
     df05e56..ce42b80  master -&gt; master
</code></pre>

<p>If the deploy succeeds, then website should be available on the internet and you are done!  If the deploy fails, the push will be cancelled and you&rsquo;ll need to investigate why that might be.  I would first check the permissions on all of the directories mentioned above.</p>

<p>Finally, as a little bonus, the script creates a <code>deployed_commit</code> file which contains the commit SHA of the commit the build was based on; useful if something goes wrong or you just want to check what you last deployed.  You can even check my site&rsquo;s deployed commit (update: now defunct)!</p>

<p>[migrate-to-jekyll]: {% post_url 2015-10-04-migrating-from-wordpress-to-jekyll %}</p>

                
              </div>

              
            </article>
          
            <article class="post-preview">
              <a href="/post/javascript-promises-notes/">
                <h2 class="post-title">JavaScript Promises Notes</h2>
                
                
              </a>

              <span class="post-meta">
  
  
  <i class="fa fa-calendar-o"></i>&nbsp;Posted on November 7, 2015
  
  
  
</span>


              <div class="post-entry">
                
                  

<p>Some notes to remind future me why Promises are pretty neat.</p>

<h1 id="what-do-they-give-me">What do they give me?</h1>

<ul>
<li>They let you regain error handling for asynchronous operations.</li>
<li>They let you avoid nested callbacks (and the pyramid indentation that comes with them).</li>
</ul>

<h1 id="can-i-use-them">Can I use them?</h1>

<p>They were initially formalised in the <a href="https://promisesaplus.com/">Promises/A+ specification</a>, and have been <a href="http://www.ecma-international.org/ecma-262/6.0/#sec-promise-objects">officially adopted in to JavaScript with ES6</a>.</p>

<p>They&rsquo;ve been supported in <a href="http://caniuse.com/#feat=promises">all major browsers (except IE) for a while now</a>.  <a href="https://github.com/jakearchibald/es6-promise">A polyfill exists</a> for browsers that do not support them.</p>

<h1 id="any-important-details">Any important details?</h1>

<ul>
<li>Promises <em>can</em> start executing the instant they have been instantiated.  However, this does not strictly mean that they will be.</li>
<li>If you call <code>.then(success_function, failure_function)</code> on a Promise, the appropriate <code>function</code> will not be called until <a href="https://github.com/domenic/promises-unwrapping/blob/master/docs/states-and-fates.md">a Promise has <em>settled</em></a> &mdash; either fulfilled or rejected.</li>
<li>Calling <code>.catch()</code> is equivalent to calling <code>.then(null, function)</code>.</li>
</ul>

<h1 id="i-need-help-visualising-them">I need help visualising them</h1>

<p>Try <a href="http://bevacqua.github.io/promisees/">Promisees</a> &mdash; it&rsquo;ll visualise and animate the promise-y code you give it.  You can also slow down the animation and record animated GIFs!</p>

                
              </div>

              
            </article>
          
            <article class="post-preview">
              <a href="/post/fix-installing-packages-for-python2-in-opensuse/">
                <h2 class="post-title">Fix installing packages for python2 in openSUSE</h2>
                
                
              </a>

              <span class="post-meta">
  
  
  <i class="fa fa-calendar-o"></i>&nbsp;Posted on October 14, 2015
  
  
  
</span>


              <div class="post-entry">
                
                  <p>If you have both <code>python2</code> and <code>python3</code> installed on openSUSE, you might find when you use <code>pip</code> to install packages <a href="https://forums.opensuse.org/showthread.php/504571-A-question-regarding-pip-s-default-installation-path">that they install for <code>python3</code></a>, not <code>python2</code>!</p>

<p>This seems to be because the <code>pip</code> command that is run comes directly from the <code>python3</code> install.</p>

<p>To fix it, install the <code>python-pip</code> SUSE package, then use it as default:</p>

<pre><code>zypper install -n python-pip
update-alternatives --config pip
</code></pre>

<p>When prompted for which <code>pip</code> to use, ensure you select the <code>python2</code> version.</p>

<p>Now when you use <code>pip</code>, you&rsquo;re modifying <code>python2</code>.  To modify <code>python3</code>, run <code>pip3</code>.</p>

                
              </div>

              
            </article>
          
            <article class="post-preview">
              <a href="/post/enable-spell-checking-in-sublime-text-for-markdown-or-any-individual-syntax/">
                <h2 class="post-title">Enable spell checking in Sublime Text just for Markdown (or any individual syntax)</h2>
                
                
              </a>

              <span class="post-meta">
  
  
  <i class="fa fa-calendar-o"></i>&nbsp;Posted on October 10, 2015
  
  
  
</span>


              <div class="post-entry">
                
                  <ol>
<li>Open or create a Markdown document (or another file type you want to enable spell-checking for)</li>
<li>Go to <strong>Preferences &gt; Settings - More &gt; Syntax Specific - User</strong></li>

<li><p>Add the following code:</p>

<pre><code>{
    &quot;spell_check&quot;: true
}
</code></pre></li>
</ol>

<p>If you&rsquo;ve made any spelling errors or used some funky words, you should notice some of the titular red squiggly lines.</p>

<p>Incidentally, you can set any option for individual syntaxes in this manner.</p>

                
              </div>

              
            </article>
          
            <article class="post-preview">
              <a href="/post/getting-battery-life-back-on-an-acer-aspire-5820tg-running-windows-10/">
                <h2 class="post-title">Getting battery life back on an Acer Aspire 5820TG running Windows 10</h2>
                
                
              </a>

              <span class="post-meta">
  
  
  <i class="fa fa-calendar-o"></i>&nbsp;Posted on October 9, 2015
  
  
  
</span>


              <div class="post-entry">
                
                  

<p>Details upfront: My workaround is to completely disable the AMD GPU via a modded BIOS and let Windows Update install a valid driver for the Intel card.  If this concerns you, then don&rsquo;t follow the instructions on this page!</p>

<p>==Disclaimer: I can&rsquo;t be held responsible should things go wrong etc. etc.  I can only describe what worked for me.==</p>

<h2 id="i-ll-be-careful-instructions-please">I&rsquo;ll be careful. Instructions please!</h2>

<p>I first made sure that I had uninstalled all of the graphics drivers.  I would do this by uninstalling the drivers (either via <em>Device Manager</em> or <em>Programs &amp; Features</em>), rebooting in to Safe Mode (hold <code>Shift</code> while clicking <em>Restart</em> in the <em>Start Menu</em>, then find the Advanced Boot Options command) and using something like <a href="https://treexy.com/products/driver-fusion">Driver Fusion</a> to eradicate the AMD and Intel drivers.</p>

<p>I installed the <a href="http://forum.notebookreview.com/threads/acer-aspire-timelinex-4820tg-5820tg-modded-bios-insyde.568951/">modded BIOS available on Notebook Review&rsquo;s forum</a>.  That same page also has some useful instructions should things go wrong!</p>

<p>I then rebooted in to the BIOS and set the graphics mode to the newly-added <em>Integrated</em>.  Note that if you shut down Windows 10 it will still seem to flag to the BIOS that it is hibernating (likely one of the many ways Microsoft have sped up boot times), which means you can&rsquo;t access the BIOS; I&rsquo;ve found that restarting always gives me the option.</p>

<p>I then reboot to Windows, check <em>Device Manager</em> to see that only one graphics device shows up (on the Acer 5820TG, if the AMD GPU is enabled you&rsquo;ll see 2 devices), then go to <em>Start &gt; Settings &gt; Update &gt; Check for Updates</em>.  Windows 10 will, in short order, get to installing the Intel driver (assuming you haven&rsquo;t disabled it!).</p>

<p>My personal testing suggests that this is about as good as when you would have normally switched to Integrated graphics, which is good.  <a href="https://batterybarpro.com/">BatteryBar Pro</a> tells me that when the laptop is idle with WiFi on and the screen on the battery discharge rate in the 7,000-8,000mW region, which is excellent for this machine.</p>

<h2 id="why-remove-the-amd-card-entirely">Why remove the AMD card entirely?</h2>

<p>In Windows 10 Microsoft have made the decision to automatically install the most up-to-date drivers it has for all the hardware connected to your machine.</p>

<p>It&rsquo;s noble, but the problem here is that the up-to-date driver for the graphics cards in this machine doesn&rsquo;t properly utilise switching.  It instead uses both GPUs all the time &mdash; leading to lacklustre battery life.  So I would install a much older driver that I know works (and still behaves correctly in Windows 10) instead.</p>

<p>However, there is no easy way to opt-out of driver updated.  The option in System to tell Windows Update to not install drivers is ignored.  The only way I know of to stop the updates is to hide them before they&rsquo;re installed by using <a href="https://support.microsoft.com/en-gb/kb/3073930">a troubleshooter explicitly for this purpose</a>; indeed, the functionality to disable updates is no longer built in to Windows.  At least you can store the troubleshooter somewhere and keep running it to pretend the functionality is still there.</p>

<p>But there was a hitch: even once I&rsquo;d hidden the AMD graphics driver update, it was still getting installed sooner or later.</p>

<p>I also found that so long as I stuck exclusively with the Intel card then everything was OK and Windows could not detect the AMD hardware.  But as soon as I switched to the AMD GPU (such as can automatically happen when you connect a power supply), it effectively enabled a kill switch for the graphics driver in Windows as it&rsquo;ll sooner or later install the up-to-date driver against my wishes.</p>

<p>I figured that it would just be a whole lot simpler to run with the one GPU and bypass the switchable business.  The default BIOS lets you choose between <em>Discrete</em> and <em>Switchable</em> configurations, but I wanted an <em>Integrated</em> option.  That&rsquo;s where the modded BIOS came in.</p>

<h2 id="but-i-don-t-want-to-lose-my-amd-card">But I don&rsquo;t want to lose my AMD card!</h2>

<p>I might revisit this at some point, because while figuring all this stuff out I noticed something odd.</p>

<p>I went the one GPU route because I found that, despite disabling the update, the AMD graphics driver would still install.  Except it might <em>not</em> have been the AMD graphics driver that was installing.</p>

<p>Once I had disabled the AMD GPU and rebooted, I noted that another option appeared in the disable update troubleshooter: the AMD HDMI audio driver.</p>

<p>I had already noted by this point that despite the fact that <em>something</em> would install and hose the driver, the driver version reported in Device Manager would not always change.  This could be quite neatly explained if the HDMI audio driver, which wouldn&rsquo;t change the <em>graphics</em> driver version, had enough stuff in it to stop the graphics driver working.</p>

<p>Now that I&rsquo;ve disabled both the AMD graphics driver and the AMD HDMI audio driver, perhaps I could re-enable the switchable graphics configuration.</p>

<p>One last note: assuming that hiding updates works in Windows 10 like it did in previous Windows releases, then hiding an update only hides <em>that version</em>.  That means that if either driver were to get updated in future, you&rsquo;ll probably have to go through the entire rigmarole again (hide update, uninstall, reinstall) to get a working driver again.</p>

                
              </div>

              
            </article>
          
            <article class="post-preview">
              <a href="/post/troubleshooting-keyboard-shortcuts-in-sublime-text/">
                <h2 class="post-title">Troubleshooting keyboard shortcuts in Sublime Text</h2>
                
                
              </a>

              <span class="post-meta">
  
  
  <i class="fa fa-calendar-o"></i>&nbsp;Posted on October 8, 2015
  
  
  
</span>


              <div class="post-entry">
                
                  

<p>I recently installed a couple of new plugins to Sublime Text, and then <code>Ctrl+Shift+R</code>, the shortcut for searching through all symbols in a project, stopped working!</p>

<p>You can get Sublime Text to display what&rsquo;s actually going on when you press the shortcut &mdash; that information may give you a hint as to what plugin or configuration has changed your value.</p>

<h2 id="is-the-shortcut-reaching-sublime">Is the shortcut reaching Sublime?</h2>

<p>The following commands are run in the Sublime Text Console; you can access on Linux and Windows by pressing <code>Ctrl+`</code>.</p>

<p>You can check the shortcut is actually managing to get to Sublime in the first place:</p>

<pre><code>sublime.log_input(True)
</code></pre>

<p>You&rsquo;ll notice that the console will now display the keys that you press &mdash; try pressing a keyboard shortcut too!</p>

<pre><code>key evt: shift+control+r
</code></pre>

<p>If the console is showing your keystrokes correctly, then Sublime is receiving them loud and clear and the problem lies elsewhere.</p>

<h2 id="what-is-sublime-doing-when-the-shortcut-is-invoked">What is Sublime doing when the shortcut is invoked?</h2>

<p>By running the following in the Sublime console, you&rsquo;ll see what commands Sublime is running as you press keyboard shortcuts:</p>

<pre><code>sublime.log_commands(True)
</code></pre>

<p>You&rsquo;ll now note the command names appearing inside of the console.  I got the following:</p>

<pre><code>key evt: shift+control+r
command: run_emmet_action {&quot;action&quot;: &quot;reflect_css_value&quot;}
</code></pre>

<p>In my case, it turned out that <a href="https://github.com/sergeche/emmet-sublime">Emmet</a> had taken over the shortcut!  I got my shortcut back by copying the default <code>Ctrl+Shift+R</code> shortcut definition from <em>Preferences &gt; Keybindings - Default</em> and pasting it in to the user file at <em>Preferences &gt; Keybindings - User</em>.</p>

<pre><code>[
    { &quot;keys&quot;: [&quot;ctrl+shift+r&quot;], &quot;command&quot;: &quot;goto_symbol_in_project&quot; }
]
</code></pre>

<p>I feel there should be a better way to do this, but this works as Sublime is now.  Now I try the shortcut again:</p>

<pre><code>key evt: shift+control+r
command: goto_symbol_in_project
</code></pre>

<p>Much better.</p>

<h2 id="emmet-has-its-own-special-shortcut-handling">Emmet has its own special shortcut handling</h2>

<p>Those of you familiar with Emmet might know that it has <a href="https://github.com/sergeche/emmet-sublime#overriding-keyboard-shortcuts">its own built-in mechanism</a> to disable keyboard shortcuts of your choice.  And in this case, that&rsquo;s exactly what could be used.</p>

<pre><code>&quot;disabled_keymap_actions&quot;: &quot;reflect_css_value&quot;
</code></pre>

<p>The nice thing about the keybindings override is that the instructions described above should work for any addon package <a href="http://www.sublimetext.com/docs/3/packages.html">as the User package is sourced last</a> &mdash; meaning that the User package overrides all.</p>

                
              </div>

              
            </article>
          
            <article class="post-preview">
              <a href="/post/migrating-from-wordpress-to-jekyll/">
                <h2 class="post-title">Migrating from Wordpress to Jekyll</h2>
                
                
              </a>

              <span class="post-meta">
  
  
  <i class="fa fa-calendar-o"></i>&nbsp;Posted on October 4, 2015
  
  
  
</span>


              <div class="post-entry">
                
                  <p>I&rsquo;ve recently moved from the rather dynamic Wordpress to the rather static Jekyll.  Can you tell?</p>

<p>I&rsquo;ve come to like the idea of simply serving a bunch of static files instead of dynamically building them when required.  Static files are simple, cheap to host and serve, introduce no further security problems beyond the web server and configuration, and easy enough for me, as a developer, to edit.</p>

<p>I&rsquo;ve still got plenty of hurdles to work through &mdash; in particular how to host all my pictures &mdash; but this can all be worked out over time one way or another (including reverting back to Wordpress!).</p>

<p>I just wanted to scrawl a few notes about my discoveries &mdash; and what better way to do it than within the blog itself!</p>

<ul>
<li><p>If you run <code>jekyll serve</code> inside of a VM (like Virtualbox) or container (like Docker), if you want to hit the site outside of the VM then make sure to specify <code>--host=0.0.0.0</code> so the server binds to the outside network interface instead of the loopback interface.</p></li>

<li><p>I exported the Wordpress data by using the <a href="https://github.com/benbalter/wordpress-to-jekyll-exporter">jekyll-export plugin</a>.  The <a href="http://import.jekyllrb.com/docs/wordpress/">script recommended by Jekyll&rsquo;s own import website</a> produced a bunch of HTML which did not play well with Jekyll.</p></li>

<li><p>One thing I wanted to do afterwards is convert many of the HTML entities to simpler equivalents, like <code>’</code> to <code>'</code> and <code>“</code> and <code>”</code> to <code>&quot;</code>.  I did this to make my files easily readable and editable, in the spirit of Markdown.  A <a href="http://serverfault.com/questions/440805/how-can-i-easily-convert-html-special-entities-from-a-standard-input-stream-in-l">quick way to do this</a> is to run the following:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#66d9ef">for</span> post in _posts/*; <span style="color:#66d9ef">do</span> cat <span style="color:#e6db74">&#34;</span>$post<span style="color:#e6db74">&#34;</span> | perl -n -mHTML::Entities -e <span style="color:#e6db74">&#39;use open ( &#34;:encoding(UTF-8)&#34;, &#34;:std&#34; ); print HTML::Entities::decode_entities($_) ;&#39;</span> &gt; $post.new <span style="color:#f92672">&amp;&amp;</span> mv $post.new $post; <span style="color:#66d9ef">done</span></code></pre></div>
<p>You&rsquo;ll also need to convert any pages that were brought across too.</p>

<p>The <code>use open ( &quot;:encoding(UTF-8)&quot;, &quot;:std&quot; );</code> part is of as it instructs perl that <a href="http://blog.thewebsitepeople.org/2012/06/perl-default-to-utf-8-encoding/">all input and output streams are UTF-8</a>.</p></li>

<li><p>You see that code block nested inside the list above?  That <a href="https://github.com/jekyll/jekyll/issues/588">cannot be done with Jekyll and Markdown</a>.  This is because the <code>{% raw %}{% highlight %}{% endraw %}</code> code Jekyll uses is substituted before the markdown is parsed.  If you want highlighting, this means you need to use the <code>~~~</code> fenced code blocks.</p>

<p>You could try <a href="https://github.com/mvdbos/kramdown-with-pygments">adding pygments support to Kramdown</a>.  Alternatively, you can switch to a renderer, like <a href="https://github.com/vmg/redcarpet">redcarpet</a>, that does support it.  This may well come and bite me in the future.</p></li>
</ul>

<p>After all of these changes, my markup (or should I say markdown?) started to look respectable &mdash; although there&rsquo;s a long way to go!</p>

                
              </div>

              
            </article>
          
        </div>

        
          <ul class="pager main-pager">
            
              <li class="previous">
                <a href="/page/2/">&larr; Newer Posts</a>
              </li>
            
            
              <li class="next">
                <a href="/page/4/">Older Posts &rarr;</a>
              </li>
            
          </ul>
        
      </div>
    </div>
  </div>

    <footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
              <li>
                <a href="https://github.com/XanderXAJ" title="GitHub">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://twitter.com/XanderXAJ" title="Twitter">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://stackoverflow.com/users/5893392/alex-palmer" title="StackOverflow">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-stack-overflow fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://www.youtube.com/channel/UCIqfeTPDnN9doZzKlVXpqww" title="Youtube">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-youtube fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://xanderxaj.bandcamp.com/" title="Bandcamp">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-bandcamp fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
        </ul>
        <p class="credits copyright text-muted">
          
            
              <a href="https://xanderx.com">Alex Palmer</a>
            
          

          &nbsp;&bull;&nbsp;
          2018

          
            &nbsp;&bull;&nbsp;
            <a href="/">Forged Defiance</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          <a href="http://gohugo.io">Hugo v0.45</a> powered &nbsp;&bull;&nbsp; Theme by <a href="http://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a> adapted to <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a>
          
        </p>
      </div>
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.js" integrity="sha384-/y1Nn9+QQAipbNQWU65krzJralCnuOasHncUFXGkdwntGeSvQicrYkiUBwsgUqc1" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/contrib/auto-render.min.js" integrity="sha384-dq1/gEHSxPZQ7DdrM82ID4YVol9BYyU7GbWlIwnwyPzotpoc57wDw/guX8EaYGPx" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="/js/main.js"></script><script> renderMathInElement(document.body); </script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js" integrity="sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js" integrity="sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q" crossorigin="anonymous"></script>
<script src="/js/load-photoswipe.js"></script>






  </body>
</html>

